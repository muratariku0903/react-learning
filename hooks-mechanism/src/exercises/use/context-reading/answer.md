# 言語化演習 回答

## 1. use がトップレベル制約に縛られない利点の具体例

**回答：**
例えば、ログインをしているかしていないかで表示が切り替わるような画面があったとして、ログインしていた場合に何かしらのコンテキストを参照してその情報を表示する。ログインしていなかったら早期的にログインしてくださいみたいな仮のコンポーネントを表示するみたいなのがあったときにユーズを使わない場合はいずれにせよトップレベルでコンテキスト参照するフックを実行する必要があると思います。なのでログインしているかしていないかに関わらずコンテキストを取得する処理が走ってしまう。そこでUseを使ってコンテキストを取得することで、本当に必要なときにのみコンテキストを取得する、それを実行することができるので、不要な処理をスキップできるという利点があると思います。

> **✅ 評価: 正しい** - ログイン状態に応じた条件付きContext読み取りは、`use`の利点を的確に示す具体例です。

---

## 2. useContext と use の動作の違い（showTheme が false のとき）

**回答：**
回答1と重複する内容になってしまいますが、パターンAの場合は、showThemeの値によらずコンテキストを取得する処理が必ず毎回実行されるのに対して、パターンBはshowThemeの値がtrueのときだけコンテキストを取得する処理が実行されます。

> **✅ 評価: 概ね正しい** - 呼び出しの有無の違いは正確です。補足として、表示結果自体はどちらも同じ（showThemeがfalseなら「テーマ非表示」を返す）点も押さえておくと良いです。違いは「不要なContext購読をスキップできるか」という意図の明確さにあります。

---

## 3. use を使うときに守るべきルール・注意点

**回答：**
Useの呼び出し時にPromiseを生成することは極力避ける。理由としては、もしそのuseを実行しているコンポーネントが何かしらのSuspenseによってラップされている場合、無限ループする可能性があるためです。なので、useで引き受けるPromiseっていうのは、外部で事前に定義されてあると安心してPromiseを処理できるかなと思います。
また、他のフックと同様に呼び出せる場所は React コンポーネントと Custom Hook 内のみであり、他の普通の関数の中で呼び出したりすることはできません。

> **⚠️ 評価: 漏れあり** - Promiseの参照同一性とコンポーネント/カスタムHook内制約は正しいです。もう1点考えてみてください：
>
> **追加質問:** `use`はif文やループ内で呼べますが、「try/catchブロックの中」で`use`を呼び出すことについてはどうでしょうか？`use`にPromiseを渡すとき、try/catch内で呼ぶとどんな問題が起きそうか考えてみてください。
Useをtry-catch区の中で呼び出してはならない。理由としては、try区の中でuseを実行すると、useはプロミスするので、そうするとcatch区でプロミスがキャッチされてしまって、大元でラップしているサスペンスにまでプロミスが届かないことになってしまうので、ローディング制御ができなくなってしまうから。

> **✅ 評価: 正しい** - `use`がPromiseをスロー → try/catchがキャッチ → Suspenseに届かない → ローディング制御不能、という因果関係を正確に説明できています。これは`use`の重要な制約の一つです。

