# stateとrefの使い分け

## 目的

この演習では、`state`と`ref`の本質的な違いを理解し、それぞれをどのような場面で使うべきかを判断できるようになることを目指します。

---

## 要件

### 言語化演習（answer.mdに回答）

以下の問いに答えてください。

#### 問1: 判断基準

あるデータを`state`で管理するか`ref`で管理するかを判断する際の、最も重要な基準は何ですか？自分の言葉で説明してください。

#### 問2: 具体的なケース分析

以下の各ケースについて、`state`と`ref`のどちらを使うべきか答え、その理由を説明してください。

1. ユーザーが入力したテキストを画面に表示する
2. 前回のpropsの値を保存しておいて、変更があったか比較する
3. モーダルの開閉状態を管理する
4. 外部ライブラリのインスタンスを保持する（例: Chart.jsのチャートオブジェクト）
5. アニメーションのrequestAnimationFrameのID

#### 問3: アンチパターンの理由

以下のコードはReactのアンチパターンです。なぜ問題なのか説明してください。

```tsx
function BadExample() {
  const isLoggedIn = useRef(false);

  const handleLogin = () => {
    isLoggedIn.current = true;
    // ログイン成功後の処理
  };

  return (
    <div>
      {isLoggedIn.current ? (
        <p>ようこそ！</p>
      ) : (
        <button onClick={handleLogin}>ログイン</button>
      )}
    </div>
  );
}
```

---

### 実装演習（design.mdに設計を書いてから実装）

#### 課題: 「前回の値」を表示するコンポーネントの修正

`components/PreviousValue.tsx`には、現在の値と「前回の値」を表示するコンポーネントが実装されています。しかし、このコンポーネントには問題があります。

**現状の問題:**

- 「+1」ボタンを押しても、「前回の値」が正しく表示されない
- コンソールを確認すると、不必要な再レンダリングが発生している

**課題:**

1. まず、現在の実装を動かして問題を確認してください
2. 問題の原因を分析し、`design.md`に記述してください
3. `state`と`ref`を適切に使い分けて修正してください

**期待される動作:**

- 「+1」ボタンを押すと、現在の値が+1される
- 「前回の値」には、ボタンを押す前の値が表示される
- 不必要な再レンダリングが発生しない

---

## 制約条件

- `usePrevious`のようなカスタムHookを使用しても構いません
- 状態管理ライブラリは使用しないこと

---

## ファイル構成

```
state-vs-ref/
├── README.md      ← この課題文
├── answer.md      ← 言語化演習の回答
├── design.md      ← 実装演習の設計メモ
├── notes.md       ← 学びログ
├── App.tsx        ← エントリーポイント
└── components/
    └── PreviousValue.tsx  ← 修正対象
```
