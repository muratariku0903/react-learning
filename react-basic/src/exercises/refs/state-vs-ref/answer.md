# stateとrefの使い分け - 回答

## 問1: 判断基準

表示に関わるデータかどうか  
そのデータが更新されたら再度レンダリングして欲しいかどうか



---

## 問2: 具体的なケース分析

### 1. ユーザーが入力したテキストを画面に表示する

- 使うべきもの:state
- 理由:画面に表示するデータだから

### 2. 前回のpropsの値を保存しておいて、変更があったか比較する

- 使うべきもの:ref
- 理由:画面表示とは関係ないデータだから

### 3. モーダルの開閉状態を管理する

- 使うべきもの:state
- 理由:画面表示に関係するデータだから

### 4. 外部ライブラリのインスタンスを保持する

- 使うべきもの:ref
- 理由:画面表示に関係しないデータだから。外部ライブラリのインスタンスの更新がレンダリングとは無関係。

### 5. アニメーションのrequestAnimationFrameのID

- 使うべきもの:ref
- 理由:画面表示に関係しないデータだから。アニメーションを停止させるために保持しておくためのデータ。

---

## 問3: アンチパターンの理由

画面表示に関わるデータをrefで管理してるから。
この場合、ref管理下データがイベントハンドラ内で更新されようと再レンダリングが実施されないため、表示が切り替わらない。

---

## 評価コメント（言語化演習完了）

### 問1 ✅
「表示に関わるデータかどうか」「再度レンダリングして欲しいかどうか」という2つの観点は、state vs refの判断基準として本質を捉えています。

### 問2 ✅
5つのケースすべて正しく判断できています。特に、外部ライブラリのインスタンスやrequestAnimationFrameのIDについて「画面表示に関係しない」「保持しておくためのデータ」と明確に理由付けできているのが良いです。

### 問3 ✅
アンチパターンの問題点を正確に指摘しています。「ref管理下データが更新されても再レンダリングが実施されないため、表示が切り替わらない」という説明は簡潔で的確です。

補足：このパターンは「Reactの宣言的UIモデルに反している」とも言えます。Reactは「state → render → DOM」という流れを前提としており、refでUI状態を管理すると、その流れをバイパスしてしまいます。
