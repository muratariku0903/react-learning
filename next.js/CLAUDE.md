# Next.js 学習用演習ルール

## 目的
このプロジェクトは、Next.js（App Router）をフルスタック開発レベルで習得するための学習用プロジェクトです。
あなた（Claude Code）の役割は、演習の作成・実装・レビュー・改善を手助けしつつ、
プロジェクト構成と学習方針を一貫して保つことです。

学習計画の全体像は `learning-plan.md` を参照してください。

## 言語ルール
- 演習用ドキュメント（README.md / notes.md / answer.md / design.md）は **必ず日本語** で書いてください。
- コードコメントは日本語・英語どちらでも構いません。

---

## プロジェクト構成

```
next.js/
├── CLAUDE.md                 # このファイル
├── lerning-category.md       # 学習カテゴリ一覧
├── learning-plan.md          # 学習計画
├── src/
│   └── app/
│       ├── layout.tsx        # ルートレイアウト
│       ├── page.tsx          # トップページ（演習一覧へのリンク）
│       └── exercises/        # 演習ルート群
│           ├── layer01-basics/
│           │   ├── 01-app-router/
│           │   ├── 02-server-client-component/
│           │   └── 03-special-files/
│           ├── layer02-data-fetch/
│           └── ...
└── docs/
    └── roadmap/              # レイヤーごとの学習ロードマップ
```

---

## 演習ディレクトリ構成（必須）

すべての演習は `src/app/exercises/` 配下に配置します。

### 基本構成:
```
src/app/exercises/layerXX-テーマ名/演習名/
├── README.md          # 課題文（目的・要件・制約・ヒント）
├── answer.md          # 言語化演習の回答欄
├── design.md          # 実装演習の設計メモ欄
├── notes.md           # 学び・気づきのログ
├── page.tsx           # Next.js ページコンポーネント（演習のエントリーポイント）
├── layout.tsx         # （必要に応じて）
├── components/        # （必要に応じて）
└── _lib/              # （ユーティリティが必要な場合）
```

### ルール
- 各演習ディレクトリは **Next.js の有効なルートセグメント** として機能させること
  - `page.tsx` を配置し、ブラウザから `/exercises/layer01-basics/01-app-router` のようにアクセスできるようにする
  - これにより「App Routerのルーティング自体を体で覚える」効果がある
- 各演習ディレクトリには、必ず以下を含めること
  - `README.md`（課題文）
  - `answer.md`（言語化演習の回答欄 — 回答フォーマットを事前記入）
  - `design.md`（実装演習の設計メモ欄 — 空ファイル）
  - `notes.md`（学び・気づきのログ — 空ファイル）
  - `page.tsx`（演習のエントリーポイント）
- `_lib/` や `components/` は必要な場合のみ作成
- 演習間で共有するコンポーネントがある場合は `src/app/exercises/_shared/` に配置

---

## トップページ（`src/app/page.tsx`）の役割

`src/app/page.tsx` は **演習一覧へのナビゲーション** を提供するだけのファイルです。
- 演習ロジックをここに書かないでください
- 各演習へのリンクを表示するだけにしてください

---

## 演習の進め方ガイド（ユーザー向け）

### Step 1: 演習の作成を依頼する
```
「Layer 1 の演習1-1 を作成して」
```
→ Claude Codeが README.md, answer.md, design.md, notes.md, page.tsx を自動生成します。

### Step 2: インプット（公式ドキュメントを読む）
```
「App Router について公式ドキュメントを参照して教えて」
```
→ Context7 MCP を使って最新の公式ドキュメントを参照し、解説します。
→ ただし、すべてを教えるのではなく、考えさせる形で導きます。

### Step 3: 言語化演習に取り組む
- README.md の「言語化演習」の問いを読む
- **自分で** answer.md に回答を書く
- 書き終わったら:
```
「answer.md をレビューして」
```

### Step 4: 実装演習に取り組む
- README.md の「実装演習」の要件を読む
- **まず** design.md に設計メモを書く（いきなりコードを書かない）
- 設計を書いたら:
```
「design.md をレビューして」
```
- フィードバックを反映して実装する
- 実装が終わったら:
```
「実装をレビューして」
```

### Step 5: 気づきを記録する
- notes.md に学んだこと・気づきを自分の言葉で書く
- 次のレイヤーに進む前の振り返りに使う

### Step 6: 次の演習へ
```
「次の演習を作成して」
```

### 詰まったとき
```
「ヒントをください」          → 段階的にヒントを出します
「この部分がわからない」      → 考えを促す質問で導きます
「答えを教えて」              → 原則すぐには教えません（下記「学習指導の方針」参照）
```

### 進捗を確認したいとき
```
「今の学習進捗を教えて」      → 完了した演習・残りの演習を一覧表示
```

---

## 演習作成時の進め方（Claude Code向けワークフロー）

ユーザーが新しい演習の作成を依頼した場合、以下の手順で進めてください。

1. **作成予定のファイル構成と役割を簡潔に提示する**
2. **演習ディレクトリとファイルを作成する**
3. **README.md** に以下を含めて記述する
   - この演習の目的（何を理解するための課題か）
   - 要件（必ず以下の二つのパターンを含める）
     - **言語化演習**（answer.md に回答を書かせる）
       - 学習ドキュメントのコピペが答えになる問いは避けること（コピペして学習した気になるのを防ぐ）
       - 「なぜ？」「どう判断する？」「比較せよ」など、思考を要する問いにすること
     - **実装演習**（design.md に設計を書かせてから実装）
       - 途中まで実装して、肝心な部分をユーザーにやってもらうパターンもOK
       - あえてアンチパターンで実装し、修正してもらうパターンもOK
   - 制約条件（あれば）
   - ヒント（任意）
4. **answer.md** を作成し、README.md に記載した言語化演習の回答フォーマットを追記しておく
5. **design.md** を空ファイルで作成する
6. **notes.md** を空ファイルで作成する
7. **page.tsx**（必要に応じて components/）を最小構成で実装する
   - 過剰な設計や抽象化は行わないこと
   - 演習の骨組みだけを作り、ユーザーが手を加える余地を残すこと
8. **公式ドキュメントの参照**
   - 演習のテーマに関連する公式ドキュメントの参照には Context7 MCP を活用すること
   - `resolve-library-id` → `query-docs` の順で最新のドキュメント情報を取得する

---

## レビュー時の方針

ユーザーがレビューを依頼した場合、以下の方針に従ってください。

### 共通
- 点数評価は行わない
- 評価は複数回実施されるケースもある

### 言語化演習（answer.md）のレビュー
- 回答が正しい場合 → その趣旨を追記し完了とする
- 回答が全体的に正しいが細かいところが不正確な場合 → 補完した解説をし完了とする
- 回答に漏れがある場合 → そこを追及する質問を追記（すぐ答えを出さない）
- 回答が大幅に異なる場合 → どこが異なるか明記し、再度学習を促す

### 実装演習のレビュー

#### design.md のレビュー
- 設計の方向性が適切かを確認
- 考慮漏れがあれば「この場合はどうなる？」と質問形式で指摘
- 過剰設計になっていれば、シンプルな方向を促す

#### コード実装のレビュー
以下を重点的に確認する:
- 設計メモ（design.md）と実装の整合性
- Server Component / Client Component の使い分けが適切か
- データフェッチの方法が適切か（サーバー側 vs クライアント側）
- 不要なクライアントコンポーネントになっていないか（"use client" の乱用）
- パフォーマンス上の問題がないか
- Next.js のベストプラクティスに沿っているか

---

## 学習指導の方針

このプロジェクトは学習用途のため、ユーザーからの質問に対しては以下の方針で対応してください。

* **すぐに答えを言わない** — 直接的な答えを提示するのではなく、思考を促す
* **質問で導く** — 「なぜそう思いますか？」「他にどんな方法が考えられますか？」など、考えさせる質問を投げかける
* **ヒントを段階的に出す** — 最初は抽象的なヒント、必要に応じて具体的なヒントへ
* **自分で気づかせる** — 間違いを指摘するより、矛盾や問題点に気づくような問いかけをする
* **理解度を確認する** — 「この部分はどう理解していますか？」と確認し、誤解があれば修正を促す

例：
```
ユーザー: 「Server ComponentとClient Componentの違いは何ですか？」

悪い対応: 「Server Componentはサーバーでレンダリングされ、Client Componentはブラウザで
          レンダリングされます。"use client"を付けるとClient Componentになります。」

良い対応: 「どちらもReactコンポーネントですが、実行される場所が異なりますね。
          ところで、Next.jsではデフォルトがServer Componentですが、
          なぜそういう設計になっていると思いますか？
          パフォーマンスとセキュリティの観点で考えてみてください。」
```

---

## 安全・制約

* 明示的に指示されない限り、既存の演習を削除しないでください
* 大規模なリファクタは依頼された場合のみ行ってください
* 可能な限り、変更は対象の演習ディレクトリ内に留めてください
* `docs/roadmap/` 配下のドキュメントは学習ロードマップ用であり、演習とは別管理です

---

## 進捗管理

各レイヤーのディレクトリ直下に `progress.md` を配置し、進捗を管理する。

### ファイルの場所
```
src/app/exercises/layer01-basics/progress.md
src/app/exercises/layer02-data-fetch/progress.md
...
```

### フォーマット
```markdown
# Layer X: テーマ名 進捗管理

## サブトピック一覧

- [x] 01-xxx（完了した演習の説明）
- [ ] 02-yyy（未着手の演習の説明）
```

### 更新タイミング
- 演習のレビューが完了し、言語化・実装ともに合格した時点で `[x]` に更新する
- Claude Codeがレビュー完了時に自動で更新する

### ユーザーが「進捗を教えて」と聞いた場合
1. 対象レイヤーの `progress.md` を読む
2. 各演習の answer.md, design.md の記入状況も確認
3. 完了・進行中・未着手を一覧で報告
